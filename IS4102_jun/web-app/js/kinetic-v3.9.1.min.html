



<!DOCTYPE html>
<html>
<head>
 <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" >
 <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" >
 
 <meta name="ROBOTS" content="NOARCHIVE">
 
 <link rel="icon" type="image/vnd.microsoft.icon" href="http://www.gstatic.com/codesite/ph/images/phosting.ico">
 
 
 <script type="text/javascript">
 
 
 
 
 var codesite_token = "5kvJgJLRw_KIbds78Pzgd2psvK0:1343011108015";
 
 
 var CS_env = {"profileUrl":["/u/102382972076143158162/"],"token":"5kvJgJLRw_KIbds78Pzgd2psvK0:1343011108015","assetHostPath":"http://www.gstatic.com/codesite/ph","domainName":null,"assetVersionPath":"http://www.gstatic.com/codesite/ph/13293733053503680815","projectHomeUrl":"/p/masiisteen","relativeBaseUrl":"","projectName":"masiisteen","loggedInUserEmail":"LiuRuTing@gmail.com"};
 var _gaq = _gaq || [];
 _gaq.push(
 ['siteTracker._setAccount', 'UA-18071-1'],
 ['siteTracker._trackPageview']);
 
 (function() {
 var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
 ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
 (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
 })();
 
 </script>
 
 
 <title>kinetic-v3.9.1.min.js - 
 masiisteen -
 
 
 Laevade Pommitamine ++ - Google Project Hosting
 </title>
 <link type="text/css" rel="stylesheet" href="http://www.gstatic.com/codesite/ph/13293733053503680815/css/core.css">
 
 <link type="text/css" rel="stylesheet" href="http://www.gstatic.com/codesite/ph/13293733053503680815/css/ph_detail.css" >
 
 
 <link type="text/css" rel="stylesheet" href="http://www.gstatic.com/codesite/ph/13293733053503680815/css/d_sb.css" >
 
 
 
<!--[if IE]>
 <link type="text/css" rel="stylesheet" href="http://www.gstatic.com/codesite/ph/13293733053503680815/css/d_ie.css" >
<![endif]-->
 <style type="text/css">
 .menuIcon.off { background: no-repeat url(http://www.gstatic.com/codesite/ph/images/dropdown_sprite.gif) 0 -42px }
 .menuIcon.on { background: no-repeat url(http://www.gstatic.com/codesite/ph/images/dropdown_sprite.gif) 0 -28px }
 .menuIcon.down { background: no-repeat url(http://www.gstatic.com/codesite/ph/images/dropdown_sprite.gif) 0 0; }
 
 
 
  tr.inline_comment {
 background: #fff;
 vertical-align: top;
 }
 div.draft, div.published {
 padding: .3em;
 border: 1px solid #999; 
 margin-bottom: .1em;
 font-family: arial, sans-serif;
 max-width: 60em;
 }
 div.draft {
 background: #ffa;
 } 
 div.published {
 background: #e5ecf9;
 }
 div.published .body, div.draft .body {
 padding: .5em .1em .1em .1em;
 max-width: 60em;
 white-space: pre-wrap;
 white-space: -moz-pre-wrap;
 white-space: -pre-wrap;
 white-space: -o-pre-wrap;
 word-wrap: break-word;
 font-size: 1em;
 }
 div.draft .actions {
 margin-left: 1em;
 font-size: 90%;
 }
 div.draft form {
 padding: .5em .5em .5em 0;
 }
 div.draft textarea, div.published textarea {
 width: 95%;
 height: 10em;
 font-family: arial, sans-serif;
 margin-bottom: .5em;
 }

 
 .nocursor, .nocursor td, .cursor_hidden, .cursor_hidden td {
 background-color: white;
 height: 2px;
 }
 .cursor, .cursor td {
 background-color: darkblue;
 height: 2px;
 display: '';
 }
 
 
.list {
 border: 1px solid white;
 border-bottom: 0;
}

 
 </style>
</head>
<body class="t4">
<script type="text/javascript">
 window.___gcfg = {lang: 'en'};
 (function() 
 {var po = document.createElement("script");
 po.type = "text/javascript"; po.async = true;po.src = "https://apis.google.com/js/plusone.js";
 var s = document.getElementsByTagName("script")[0];
 s.parentNode.insertBefore(po, s);
 })();
</script>
<div class="headbg">

 <div id="gaia">
 

 <span>
 
 
 <a href="#" id="multilogin-dropdown" onclick="return false;"
 ><u><b>LiuRuTing@gmail.com</b></u> <small>&#9660;</small></a>
 
 
 | <a href="/u/102382972076143158162/" id="projects-dropdown" onclick="return false;"
 ><u>My favorites</u> <small>&#9660;</small></a>
 | <a href="/u/102382972076143158162/" onclick="_CS_click('/gb/ph/profile');"
 title="Profile, Updates, and Settings"
 ><u>Profile</u></a>
 | <a href="https://www.google.com/accounts/Logout?continue=http%3A%2F%2Fcode.google.com%2Fp%2Fmasiisteen%2Fsource%2Fbrowse%2Ftrunk%2FBattleships%2FWebContent%2FJavascript%2Flibraries%2Fkinetic-v3.9.1.min.js%3Fr%3D196" 
 onclick="_CS_click('/gb/ph/signout');"
 ><u>Sign out</u></a>
 
 </span>

 </div>

 <div class="gbh" style="left: 0pt;"></div>
 <div class="gbh" style="right: 0pt;"></div>
 
 
 <div style="height: 1px"></div>
<!--[if lte IE 7]>
<div style="text-align:center;">
Your version of Internet Explorer is not supported. Try a browser that
contributes to open source, such as <a href="http://www.firefox.com">Firefox</a>,
<a href="http://www.google.com/chrome">Google Chrome</a>, or
<a href="http://code.google.com/chrome/chromeframe/">Google Chrome Frame</a>.
</div>
<![endif]-->



 <table style="padding:0px; margin: 0px 0px 10px 0px; width:100%" cellpadding="0" cellspacing="0"
 itemscope itemtype="http://schema.org/CreativeWork">
 <tr style="height: 58px;">
 
 <td id="plogo">
 <link itemprop="url" href="/p/masiisteen">
 <a href="/p/masiisteen/">
 
 <img src="http://www.gstatic.com/codesite/ph/images/defaultlogo.png" alt="Logo" itemprop="image">
 
 </a>
 </td>
 
 <td style="padding-left: 0.5em">
 
 <div id="pname">
 <a href="/p/masiisteen/"><span itemprop="name">masiisteen</span></a>
 </div>
 
 <div id="psum">
 <a id="project_summary_link"
 href="/p/masiisteen/"><span itemprop="description">Laevade Pommitamine ++</span></a>
 
 </div>
 
 
 </td>
 <td style="white-space:nowrap;text-align:right; vertical-align:bottom;">
 
 <form action="/hosting/search">
 <input size="30" name="q" value="" type="text">
 
 <input type="submit" name="projectsearch" value="Search projects" >
 </form>
 
 </tr>
 </table>

</div>

 
<div id="mt" class="gtb"> 
 <a href="/p/masiisteen/" class="tab ">Project&nbsp;Home</a>
 
 
 
 
 <a href="/p/masiisteen/downloads/list" class="tab ">Downloads</a>
 
 
 
 
 
 <a href="/p/masiisteen/w/list" class="tab ">Wiki</a>
 
 
 
 
 
 <a href="/p/masiisteen/issues/list"
 class="tab ">Issues</a>
 
 
 
 
 
 <a href="/p/masiisteen/source/checkout"
 class="tab active">Source</a>
 
 
 
 
 
 
 
 <div class=gtbc></div>
</div>
<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0" class="st">
 <tr>
 
 
 
 
 
 
 
 <td class="subt">
 <div class="st2">
 <div class="isf">
 
 


 <span class="inst1"><a href="/p/masiisteen/source/checkout">Checkout</a></span> &nbsp;
 <span class="inst2"><a href="/p/masiisteen/source/browse/">Browse</a></span> &nbsp;
 <span class="inst3"><a href="/p/masiisteen/source/list">Changes</a></span> &nbsp;
 
 &nbsp;
 
 
 <form action="/p/masiisteen/source/search" method="get" style="display:inline"
 onsubmit="document.getElementById('codesearchq').value = document.getElementById('origq').value">
 <input type="hidden" name="q" id="codesearchq" value="">
 <input type="text" maxlength="2048" size="38" id="origq" name="origq" value="" title="Google Code Search" style="font-size:92%">&nbsp;<input type="submit" value="Search Trunk" name="btnG" style="font-size:92%">
 
 
 
 
 
 
 </form>
 <script type="text/javascript">
 
 function codesearchQuery(form) {
 var query = document.getElementById('q').value;
 if (query) { form.action += '%20' + query; }
 }
 </script>
 </div>
</div>

 </td>
 
 
 
 <td align="right" valign="top" class="bevel-right"></td>
 </tr>
</table>


<script type="text/javascript">
 var cancelBubble = false;
 function _go(url) { document.location = url; }
</script>
<div id="maincol"
 
>

 
<!-- IE -->




<div class="collapse">
<div id="colcontrol">
<style type="text/css">
 #file_flipper { white-space: nowrap; padding-right: 2em; }
 #file_flipper.hidden { display: none; }
 #file_flipper .pagelink { color: #0000CC; text-decoration: underline; }
 #file_flipper #visiblefiles { padding-left: 0.5em; padding-right: 0.5em; }
</style>
<table id="nav_and_rev" class="list"
 cellpadding="0" cellspacing="0" width="100%">
 <tr>
 
 <td nowrap="nowrap" class="src_crumbs src_nav" width="33%">
 <strong class="src_nav">Source path:&nbsp;</strong>
 <span id="crumb_root">
 
 <a href="/p/masiisteen/source/browse/?r=196">svn</a>/&nbsp;</span>
 <span id="crumb_links" class="ifClosed"><a href="/p/masiisteen/source/browse/trunk/?r=196">trunk</a><span class="sp">/&nbsp;</span><a href="/p/masiisteen/source/browse/trunk/Battleships/?r=196">Battleships</a><span class="sp">/&nbsp;</span><a href="/p/masiisteen/source/browse/trunk/Battleships/WebContent/?r=196">WebContent</a><span class="sp">/&nbsp;</span><a href="/p/masiisteen/source/browse/trunk/Battleships/WebContent/Javascript/?r=196">Javascript</a><span class="sp">/&nbsp;</span><a href="/p/masiisteen/source/browse/trunk/Battleships/WebContent/Javascript/libraries/?r=196">libraries</a><span class="sp">/&nbsp;</span>kinetic-v3.9.1.min.js</span>
 
 

 </td>
 
 
 <td nowrap="nowrap" width="33%" align="right">
 <table cellpadding="0" cellspacing="0" style="font-size: 100%"><tr>
 
 
 <td class="flipper"><b>r196</b></td>
 
 </tr></table>
 </td> 
 </tr>
</table>

<div class="fc">
 
 
 
<style type="text/css">
.undermouse span {
 background-image: url(http://www.gstatic.com/codesite/ph/images/comments.gif); }
</style>
<table class="opened" id="review_comment_area"
><tr>
<td id="nums">
<pre><table width="100%"><tr class="nocursor"><td></td></tr></table></pre>
<pre><table width="100%" id="nums_table_0"><tr id="gr_svn196_1"

><td id="1"><a href="#1">1</a></td></tr
><tr id="gr_svn196_2"

><td id="2"><a href="#2">2</a></td></tr
><tr id="gr_svn196_3"

><td id="3"><a href="#3">3</a></td></tr
><tr id="gr_svn196_4"

><td id="4"><a href="#4">4</a></td></tr
><tr id="gr_svn196_5"

><td id="5"><a href="#5">5</a></td></tr
><tr id="gr_svn196_6"

><td id="6"><a href="#6">6</a></td></tr
><tr id="gr_svn196_7"

><td id="7"><a href="#7">7</a></td></tr
><tr id="gr_svn196_8"

><td id="8"><a href="#8">8</a></td></tr
><tr id="gr_svn196_9"

><td id="9"><a href="#9">9</a></td></tr
><tr id="gr_svn196_10"

><td id="10"><a href="#10">10</a></td></tr
><tr id="gr_svn196_11"

><td id="11"><a href="#11">11</a></td></tr
><tr id="gr_svn196_12"

><td id="12"><a href="#12">12</a></td></tr
><tr id="gr_svn196_13"

><td id="13"><a href="#13">13</a></td></tr
><tr id="gr_svn196_14"

><td id="14"><a href="#14">14</a></td></tr
><tr id="gr_svn196_15"

><td id="15"><a href="#15">15</a></td></tr
><tr id="gr_svn196_16"

><td id="16"><a href="#16">16</a></td></tr
><tr id="gr_svn196_17"

><td id="17"><a href="#17">17</a></td></tr
><tr id="gr_svn196_18"

><td id="18"><a href="#18">18</a></td></tr
><tr id="gr_svn196_19"

><td id="19"><a href="#19">19</a></td></tr
><tr id="gr_svn196_20"

><td id="20"><a href="#20">20</a></td></tr
><tr id="gr_svn196_21"

><td id="21"><a href="#21">21</a></td></tr
><tr id="gr_svn196_22"

><td id="22"><a href="#22">22</a></td></tr
><tr id="gr_svn196_23"

><td id="23"><a href="#23">23</a></td></tr
><tr id="gr_svn196_24"

><td id="24"><a href="#24">24</a></td></tr
><tr id="gr_svn196_25"

><td id="25"><a href="#25">25</a></td></tr
><tr id="gr_svn196_26"

><td id="26"><a href="#26">26</a></td></tr
><tr id="gr_svn196_27"

><td id="27"><a href="#27">27</a></td></tr
><tr id="gr_svn196_28"

><td id="28"><a href="#28">28</a></td></tr
></table></pre>
<pre><table width="100%"><tr class="nocursor"><td></td></tr></table></pre>
</td>
<td id="lines">
<pre><table width="100%"><tr class="cursor_stop cursor_hidden"><td></td></tr></table></pre>
<pre class="prettyprint lang-js"><table id="src_table_0"><tr
id=sl_svn196_1

><td class="source">/**<br></td></tr
><tr
id=sl_svn196_2

><td class="source"> * KineticJS JavaScript Library v3.9.1<br></td></tr
><tr
id=sl_svn196_3

><td class="source"> * http://www.kineticjs.com/<br></td></tr
><tr
id=sl_svn196_4

><td class="source"> * Copyright 2012, Eric Rowell<br></td></tr
><tr
id=sl_svn196_5

><td class="source"> * Licensed under the MIT or GPL Version 2 licenses.<br></td></tr
><tr
id=sl_svn196_6

><td class="source"> * Date: Apr 01 2012<br></td></tr
><tr
id=sl_svn196_7

><td class="source"> *<br></td></tr
><tr
id=sl_svn196_8

><td class="source"> * Copyright (C) 2011 - 2012 by Eric Rowell<br></td></tr
><tr
id=sl_svn196_9

><td class="source"> *<br></td></tr
><tr
id=sl_svn196_10

><td class="source"> * Permission is hereby granted, free of charge, to any person obtaining a copy<br></td></tr
><tr
id=sl_svn196_11

><td class="source"> * of this software and associated documentation files (the &quot;Software&quot;), to deal<br></td></tr
><tr
id=sl_svn196_12

><td class="source"> * in the Software without restriction, including without limitation the rights<br></td></tr
><tr
id=sl_svn196_13

><td class="source"> * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell<br></td></tr
><tr
id=sl_svn196_14

><td class="source"> * copies of the Software, and to permit persons to whom the Software is<br></td></tr
><tr
id=sl_svn196_15

><td class="source"> * furnished to do so, subject to the following conditions:<br></td></tr
><tr
id=sl_svn196_16

><td class="source"> *<br></td></tr
><tr
id=sl_svn196_17

><td class="source"> * The above copyright notice and this permission notice shall be included in<br></td></tr
><tr
id=sl_svn196_18

><td class="source"> * all copies or substantial portions of the Software.<br></td></tr
><tr
id=sl_svn196_19

><td class="source"> *<br></td></tr
><tr
id=sl_svn196_20

><td class="source"> * THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR<br></td></tr
><tr
id=sl_svn196_21

><td class="source"> * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,<br></td></tr
><tr
id=sl_svn196_22

><td class="source"> * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE<br></td></tr
><tr
id=sl_svn196_23

><td class="source"> * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER<br></td></tr
><tr
id=sl_svn196_24

><td class="source"> * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,<br></td></tr
><tr
id=sl_svn196_25

><td class="source"> * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN<br></td></tr
><tr
id=sl_svn196_26

><td class="source"> * THE SOFTWARE.<br></td></tr
><tr
id=sl_svn196_27

><td class="source"> */<br></td></tr
><tr
id=sl_svn196_28

><td class="source">var Kinetic={};Kinetic.GlobalObject={stages:[],idCounter:0,frame:{time:0,timeDiff:0,lastTime:0},drag:{moving:!1,node:undefined,offset:{x:0,y:0}},extend:function(a,b){for(var c in b.prototype)b.prototype.hasOwnProperty(c)&amp;&amp;a.prototype[c]===undefined&amp;&amp;(a.prototype[c]=b.prototype[c])},_isaCanvasAnimating:function(){for(var a=0;a&lt;this.stages.length;a++){var b=this.stages[a];if(b.isAnimating)return!0;for(var c=0;c&lt;b.children.length;c++){var d=b.children[c];if(d.transitions.length&gt;0)return!0}}return this.frame.lastTime=0,!1},_endTransition:function(){var a=this.config;for(var b in a)if(a.hasOwnProperty(b))if(a[b].x!==undefined||a[b].y!==undefined){var c=[&quot;x&quot;,&quot;y&quot;];for(var d=0;d&lt;c.length;d++){var e=c[d];a[b][e]!==undefined&amp;&amp;(this.node[b][e]=a[b][e])}}else this.node[b]=a[b]},_transitionPow:function(a,b,c,d){var e=d(),f=a.config,g=this.frame.timeDiff;if(c!==undefined){var h=a.starts[b][c],i=f[b][c]-h,j=i/Math.pow(f.duration*1e3,e);a.node[b][c]=j*Math.pow(a.time,e)+h}else{var h=a.starts[b],i=f[b]-h,j=i/Math.pow(f.duration*1e3,e);a.node[b]=j*Math.pow(a.time,e)+h}},_chooseTransition:function(a,b,c){var d=a.config,e=this;switch(d.easing){case&quot;ease-in&quot;:this._transitionPow(a,b,c,function(){return 2.5});break;case&quot;ease-out&quot;:this._transitionPow(a,b,c,function(){return.4});break;case&quot;ease-in-out&quot;:this._transitionPow(a,b,c,function(){var b=-2.1,c=b/(d.duration*1e3);return 2.5+c*a.time});break;default:this._transitionPow(a,b,c,function(){return 1})}},_runTransition:function(a){var b=a.config;for(var c in b)if(b.hasOwnProperty(c)&amp;&amp;c!==&quot;duration&quot;&amp;&amp;c!==&quot;easing&quot;&amp;&amp;c!==&quot;callback&quot;)if(b[c].x!==undefined||b[c].y!==undefined){var d=[&quot;x&quot;,&quot;y&quot;];for(var e=0;e&lt;d.length;e++){var f=d[e];b[c][f]!==undefined&amp;&amp;this._chooseTransition(a,c,f)}}else this._chooseTransition(a,c)},_clearTransition:function(a){var b=a.getLayer();for(var c=0;c&lt;b.transitions.length;c++)b.transitions[c].node.id===a.id&amp;&amp;b.transitions.splice(c,1)},_runFrames:function(){for(var a=0;a&lt;this.stages.length;a++){var b=this.stages[a];b.isAnimating&amp;&amp;b.onFrameFunc!==undefined&amp;&amp;b.onFrameFunc(this.frame);var c=b.getChildren();for(var d=0;d&lt;c.length;d++){var e=c[d],f=!1;for(var g=0;g&lt;e.transitions.length;g++){f=!0;var h=e.transitions[g];h.time+=this.frame.timeDiff,h.time&gt;=h.config.duration*1e3?(this._endTransition.apply(h),this._clearTransition(h.node),h.config.callback!==undefined&amp;&amp;h.config.callback()):this._runTransition(h)}f&amp;&amp;e.draw()}}},_updateFrameObject:function(){var a=new Date,b=a.getTime();this.frame.lastTime===0?this.frame.lastTime=b:(this.frame.timeDiff=b-this.frame.lastTime,this.frame.lastTime=b,this.frame.time+=this.frame.timeDiff)},_animationLoop:function(){if(this._isaCanvasAnimating()){this._updateFrameObject(),this._runFrames();var a=this;requestAnimFrame(function(){a._animationLoop()})}},_handleAnimation:function(){var a=this;this._isaCanvasAnimating()&amp;&amp;a._animationLoop()}},window.requestAnimFrame=function(a){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1e3/60)}}(),Kinetic.Node=function(a){this.visible=!0,this.isListening=!0,this.name=undefined,this.alpha=1,this.x=0,this.y=0,this.scale={x:1,y:1},this.rotation=0,this.centerOffset={x:0,y:0},this.eventListeners={},this.dragConstraint=&quot;none&quot;,this.dragBounds={},this._draggable=!1;if(a)for(var b in a)switch(b){case&quot;draggable&quot;:this.draggable(a[b]);break;case&quot;listen&quot;:this.listen(a[b]);break;case&quot;rotationDeg&quot;:this.rotation=a[b]*Math.PI/180;break;default:this[b]=a[b]}this.centerOffset.x===undefined&amp;&amp;(this.centerOffset.x=0),this.centerOffset.y===undefined&amp;&amp;(this.centerOffset.y=0)},Kinetic.Node.prototype={on:function(a,b){var c=a.split(&quot; &quot;);for(var d=0;d&lt;c.length;d++){var e=c[d],f=e.indexOf(&quot;touch&quot;)===-1?&quot;on&quot;+e:e,g=f.split(&quot;.&quot;),h=g[0],i=g.length&gt;1?g[1]:&quot;&quot;;this.eventListeners[h]||(this.eventListeners[h]=[]),this.eventListeners[h].push({name:i,handler:b})}},off:function(a){var b=a.split(&quot; &quot;);for(var c=0;c&lt;b.length;c++){var d=b[c],e=d.indexOf(&quot;touch&quot;)===-1?&quot;on&quot;+d:d,f=e.split(&quot;.&quot;),g=f[0];if(this.eventListeners[g]&amp;&amp;f.length&gt;1){var h=f[1];for(var i=0;i&lt;this.eventListeners[g].length;i++)if(this.eventListeners[g][i].name===h){this.eventListeners[g].splice(i,1),this.eventListeners[g].length===0&amp;&amp;(this.eventListeners[g]=undefined);break}}else this.eventListeners[g]=undefined}},show:function(){this.visible=!0},hide:function(){this.visible=!1},getZIndex:function(){return this.index},getAbsoluteZIndex:function(){function e(b){var f=[];for(var g=0;g&lt;b.length;g++){var h=b[g];d++,h.className!==&quot;Shape&quot;&amp;&amp;(f=f.concat(h.getChildren())),h.id===c.id&amp;&amp;(g=b.length)}f.length&gt;0&amp;&amp;f[0].getLevel()&lt;=a&amp;&amp;e(f)}var a=this.getLevel(),b=this.getStage(),c=this,d=0;return c.className!==&quot;Stage&quot;&amp;&amp;e(c.getStage().getChildren()),d},getLevel:function(){var a=0,b=this.parent;while(b)a++,b=b.parent;return a},setScale:function(a,b){b?(this.scale.x=a,this.scale.y=b):(this.scale.x=a,this.scale.y=a)},getScale:function(){return this.scale},setPosition:function(a,b){this.x=a,this.y=b},getPosition:function(){return{x:this.x,y:this.y}},getAbsolutePosition:function(){return this.getAbsoluteTransform().getTranslation()},move:function(a,b){this.x+=a,this.y+=b},setRotation:function(a){this.rotation=a},setRotationDeg:function(a){this.rotation=a*Math.PI/180},getRotation:function(){return this.rotation},getRotationDeg:function(){return this.rotation*180/Math.PI},rotate:function(a){this.rotation+=a},rotateDeg:function(a){this.rotation+=a*Math.PI/180},listen:function(a){this.isListening=a},moveToTop:function(){var a=this.index;this.parent.children.splice(a,1),this.parent.children.push(this),this.parent._setChildrenIndices()},moveUp:function(){var a=this.index;this.parent.children.splice(a,1),this.parent.children.splice(a+1,0,this),this.parent._setChildrenIndices()},moveDown:function(){var a=this.index;a&gt;0&amp;&amp;(this.parent.children.splice(a,1),this.parent.children.splice(a-1,0,this),this.parent._setChildrenIndices())},moveToBottom:function(){var a=this.index;this.parent.children.splice(a,1),this.parent.children.unshift(this),this.parent._setChildrenIndices()},setZIndex:function(a){var b=this.index;this.parent.children.splice(b,1),this.parent.children.splice(a,0,this),this.parent._setChildrenIndices()},setAlpha:function(a){this.alpha=a},getAlpha:function(){return this.alpha},getAbsoluteAlpha:function(){var a=1,b=this;while(b.className!==&quot;Stage&quot;)a*=b.alpha,b=b.parent;return a},draggable:function(a){this.draggable!==a&amp;&amp;(a?this._initDrag():this._dragCleanup(),this._draggable=a)},isDragging:function(){var a=Kinetic.GlobalObject;return a.drag.node!==undefined&amp;&amp;a.drag.node.id===this.id&amp;&amp;a.drag.moving},moveTo:function(a){var b=this.parent;b.children.splice(this.index,1),b._setChildrenIndices(),a.children.push(this),this.index=a.children.length-1,this.parent=a,a._setChildrenIndices(),this.name&amp;&amp;(b.childrenNames[this.name]=undefined,a.childrenNames[this.name]=this)},getParent:function(){return this.parent},getLayer:function(){return this.className===&quot;Layer&quot;?this:this.getParent().getLayer()},getStage:function(){return this.className===&quot;Stage&quot;?this:this.getParent().getStage()},getName:function(){return this.name},setCenterOffset:function(a,b){this.centerOffset.x=a,this.centerOffset.y=b},getCenterOffset:function(){return this.centerOffset},transitionTo:function(a){var b=this.getLayer(),c=this,d=a.duration*1e3,e={};Kinetic.GlobalObject._clearTransition(this);for(var f in a)if(a.hasOwnProperty(f)&amp;&amp;f!==&quot;duration&quot;&amp;&amp;f!==&quot;easing&quot;&amp;&amp;f!==&quot;callback&quot;)if(a[f].x!==undefined||a[f].y!==undefined){e[f]={};var g=[&quot;x&quot;,&quot;y&quot;];for(var h=0;h&lt;g.length;h++){var i=g[h];a[f][i]!==undefined&amp;&amp;(e[f][i]=this[f][i])}}else e[f]=this[f];b.transitions.push({id:b.transitionIdCounter++,time:0,config:a,node:this,starts:e}),Kinetic.GlobalObject._handleAnimation()},setDragConstraint:function(a){this.dragConstraint=a},getDragConstraint:function(){return this.dragConstraint},setDragBounds:function(a){this.dragBounds=a},getDragBounds:function(){return this.dragBounds},getAbsoluteTransform:function(){var a=new Kinetic.Transform,b=[],c=this.parent;b.unshift(this);while(c)b.unshift(c),c=c.parent;for(var d=0;d&lt;b.length;d++){var e=b[d],f=e.getTransform();a.multiply(f)}return a},getTransform:function(){var a=new Kinetic.Transform;return(this.x!==0||this.y!==0)&amp;&amp;a.translate(this.x,this.y),this.rotation!==0&amp;&amp;a.rotate(this.rotation),(this.scale.x!==1||this.scale.y!==1)&amp;&amp;a.scale(this.scale.x,this.scale.y),(this.centerOffset.x!==0||this.centerOffset.y!==0)&amp;&amp;a.translate(-1*this.centerOffset.x,-1*this.centerOffset.y),a},_initDrag:function(){this._dragCleanup();var a=Kinetic.GlobalObject,b=this;this.on(&quot;mousedown.initdrag touchstart.initdrag&quot;,function(c){var d=b.getStage(),e=d.getUserPosition();if(e){var f=b.getTransform().getTranslation(),g=b.getAbsoluteTransform().getTranslation();a.drag.node=b,a.drag.offset.x=e.x-b.getAbsoluteTransform().getTranslation().x,a.drag.offset.y=e.y-b.getAbsoluteTransform().getTranslation().y}})},_dragCleanup:function(){this.off(&quot;mousedown.initdrag&quot;),this.off(&quot;touchstart.initdrag&quot;)},_handleEvents:function(a,b){this.className===&quot;Shape&quot;&amp;&amp;(b.shape=this);var c=this.getStage();this._handleEvent(this,c.mouseoverShape,c.mouseoutShape,a,b)},_handleEvent:function(a,b,c,d,e){var f=a.eventListeners,g=!0;d===&quot;onmouseover&quot;&amp;&amp;c&amp;&amp;c.id===a.id?g=!1:d===&quot;onmouseout&quot;&amp;&amp;b&amp;&amp;b.id===a.id&amp;&amp;(g=!1);if(f[d]&amp;&amp;g){var h=f[d];for(var i=0;i&lt;h.length;i++)h[i].handler.apply(a,[e])}var j=b?b.parent:undefined,k=c?c.parent:undefined;!e.cancelBubble&amp;&amp;a.parent.className!==&quot;Stage&quot;&amp;&amp;this._handleEvent(a.parent,j,k,d,e)}},Kinetic.Container=function(){this.children=[],this.childrenNames={}},Kinetic.Container.prototype={getChildren:function(){return this.children},getChild:function(a){return this.childrenNames[a]},removeChildren:function(){while(this.children.length&gt;0)this.remove(this.children[0])},_remove:function(a){this.children[a.index].id==a.id&amp;&amp;(a.name!==undefined&amp;&amp;(this.childrenNames[a.name]=undefined),this.children.splice(a.index,1),this._setChildrenIndices(),a=undefined)},_drawChildren:function(){var a=this.children;for(var b=0;b&lt;a.length;b++){var c=a[b];c.className===&quot;Shape&quot;?c._draw(c.getLayer()):c._draw()}},_add:function(a){a.name&amp;&amp;(this.childrenNames[a.name]=a),a.id=Kinetic.GlobalObject.idCounter++,a.index=this.children.length,a.parent=this,this.children.push(a)},_setChildrenIndices:function(){if(this.className===&quot;Stage&quot;){var a=this.content.children,b=a[0],c=a[1];this.content.innerHTML=&quot;&quot;,this.content.appendChild(b),this.content.appendChild(c)}for(var d=0;d&lt;this.children.length;d++)this.children[d].index=d,this.className===&quot;Stage&quot;&amp;&amp;this.content.appendChild(this.children[d].canvas)}},Kinetic.Stage=function(a){typeof a.container==&quot;string&quot;&amp;&amp;(a.container=document.getElementById(a.container)),this.className=&quot;Stage&quot;,this.container=a.container,this.content=document.createElement(&quot;div&quot;),this.width=a.width,this.height=a.height,this.scale={x:1,y:1},this.dblClickWindow=400,this.clickStart=!1,this.targetShape=undefined,this.targetFound=!1,this.mouseoverShape=undefined,this.mouseoutShape=undefined,this.mousePos=undefined,this.mouseDown=!1,this.mouseUp=!1,this.touchPos=undefined,this.touchStart=!1,this.touchEnd=!1,this.id=Kinetic.GlobalObject.idCounter++,this.isAnimating=!1,this.onFrameFunc=undefined,this._buildDOM(),this._listen(),this._prepareDrag(),Kinetic.GlobalObject.stages.push(this),Kinetic.Container.apply(this,[]),Kinetic.Node.apply(this,[a])},Kinetic.Stage.prototype={onFrame:function(a){this.onFrameFunc=a},start:function(){this.isAnimating=!0,Kinetic.GlobalObject._handleAnimation()},stop:function(){this.isAnimating=!1,Kinetic.GlobalObject._handleAnimation()},draw:function(){this._drawChildren()},setSize:function(a,b){var c=this.children;for(var d=0;d&lt;c.length;d++){var e=c[d];e.getCanvas().width=a,e.getCanvas().height=b,e.draw()}this.width=a,this.height=b,this.bufferLayer.getCanvas().width=a,this.bufferLayer.getCanvas().height=b,this.pathLayer.getCanvas().width=a,this.pathLayer.getCanvas().height=b},getSize:function(){return{width:this.width,height:this.height}},clear:function(){var a=this.children;for(var b=0;b&lt;a.length;b++)a[b].clear()},toDataURL:function(a,b,c){function g(h){var i=f[h].getCanvas().toDataURL(),j=new Image;j.onload=function(){e.drawImage(this,0,0),h++;if(h&lt;f.length)g(h);else try{a(d.getCanvas().toDataURL(b,c))}catch(i){a(d.getCanvas().toDataURL())}},j.src=i}var d=this.bufferLayer,e=d.getContext(),f=this.children;d.clear(),g(0)},remove:function(a){try{this.content.removeChild(a.canvas)}catch(b){}this._remove(a)},onContent:function(a,b){var c=a.split(&quot; &quot;);for(var d=0;d&lt;c.length;d++){var e=c[d];this.content.addEventListener(e,b,!1)}},add:function(a){a.name&amp;&amp;(this.childrenNames[a.name]=a),a.canvas.width=this.width,a.canvas.height=this.height,this._add(a),a.draw(),this.content.appendChild(a.canvas)},getMousePosition:function(a){return this.mousePos},getTouchPosition:function(a){return this.touchPos},getUserPosition:function(a){return this.getTouchPosition()||this.getMousePosition()},getContainer:function(){return this.container},getContent:function(){return this.content},getStage:function(){return this},_detectEvent:function(a,b){var c=Kinetic.GlobalObject.drag.moving,d=Kinetic.GlobalObject,e=this.getUserPosition(),f=a.eventListeners;this.targetShape&amp;&amp;a.id===this.targetShape.id&amp;&amp;(this.targetFound=!0);if(a.visible&amp;&amp;e!==undefined&amp;&amp;a._isPointInShape(e)){if(!c&amp;&amp;this.mouseDown)return this.mouseDown=!1,this.clickStart=!0,a._handleEvents(&quot;onmousedown&quot;,b),!0;if(this.mouseUp)return this.mouseUp=!1,a._handleEvents(&quot;onmouseup&quot;,b),this.clickStart&amp;&amp;(!d.drag.moving||!d.drag.node)&amp;&amp;(a._handleEvents(&quot;onclick&quot;,b),a.inDoubleClickWindow&amp;&amp;a._handleEvents(&quot;ondblclick&quot;,b),a.inDoubleClickWindow=!0,setTimeout(function(){a.inDoubleClickWindow=!1},this.dblClickWindow)),!0;if(this.touchStart){this.touchStart=!1,a._handleEvents(&quot;touchstart&quot;,b);if(f.ondbltap&amp;&amp;a.inDoubleClickWindow){var g=f.ondbltap;for(var h=0;h&lt;g.length;h++)g[h].handler.apply(a,[b])}return a.inDoubleClickWindow=!0,setTimeout(function(){a.inDoubleClickWindow=!1},this.dblClickWindow),!0}if(this.touchEnd)return this.touchEnd=!1,a._handleEvents(&quot;touchend&quot;,b),!0;if(!c&amp;&amp;this._isNewTarget(a,b))return this.mouseoutShape&amp;&amp;(this.mouseoverShape=a,this.mouseoutShape._handleEvents(&quot;onmouseout&quot;,b),this.mouseoverShape=undefined),a._handleEvents(&quot;onmouseover&quot;,b),this._setTarget(a),!0;if(!c)return a._handleEvents(&quot;onmousemove&quot;,b),a._handleEvents(&quot;touchmove&quot;,b),!0}else if(!c&amp;&amp;this.targetShape&amp;&amp;this.targetShape.id===a.id)return this._setTarget(undefined),this.mouseoutShape=a,!0;return!1},_setTarget:function(a){this.targetShape=a,this.targetFound=!0},_isNewTarget:function(a,b){if(!this.targetShape||!this.targetFound&amp;&amp;a.id!==this.targetShape.id){if(this.targetShape){var c=this.targetShape.eventListeners;c&amp;&amp;(this.mouseoutShape=this.targetShape)}return!0}return!1},_traverseChildren:function(a,b){var c=a.children;for(var d=c.length-1;d&gt;=0;d--){var e=c[d];if(e.isListening)if(e.className===&quot;Shape&quot;){var f=this._detectEvent(e,b);if(f)return!0}else{var f=this._traverseChildren(e,b);if(f)return!0}}return!1},_handleStageEvent:function(a){var b=Kinetic.GlobalObject;a||(a=window.event),this._setMousePosition(a),this._setTouchPosition(a),this.pathLayer.clear(),this.targetFound=!1;var c=!1;for(var d=this.children.length-1;d&gt;=0;d--){var e=this.children[d];e.visible&amp;&amp;d&gt;=0&amp;&amp;e.isListening&amp;&amp;this._traverseChildren(e,a)&amp;&amp;(d=-1,c=!0)}!c&amp;&amp;this.mouseoutShape&amp;&amp;(this.mouseoutShape._handleEvents(&quot;onmouseout&quot;,a),this.mouseoutShape=undefined)},_listen:function(){var a=this;this.content.addEventListener(&quot;mousedown&quot;,function(b){a.mouseDown=!0,a._handleStageEvent(b)},!1),this.content.addEventListener(&quot;mousemove&quot;,function(b){a.mouseUp=!1,a.mouseDown=!1,a._handleStageEvent(b)},!1),this.content.addEventListener(&quot;mouseup&quot;,function(b){a.mouseUp=!0,a.mouseDown=!1,a._handleStageEvent(b),a.clickStart=!1},!1),this.content.addEventListener(&quot;mouseover&quot;,function(b){a._handleStageEvent(b)},!1),this.content.addEventListener(&quot;mouseout&quot;,function(b){var c=a.targetShape;c&amp;&amp;c._handleEvents(&quot;onmouseout&quot;,b),a.mousePos=undefined},!1),this.content.addEventListener(&quot;touchstart&quot;,function(b){b.preventDefault(),a.touchStart=!0,a._handleStageEvent(b)},!1),this.content.addEventListener(&quot;touchmove&quot;,function(b){b.preventDefault(),a._handleStageEvent(b)},!1),this.content.addEventListener(&quot;touchend&quot;,function(b){b.preventDefault(),a.touchEnd=!0,a._handleStageEvent(b)},!1)},_setMousePosition:function(a){var b=a.offsetX||a.clientX-this._getContentPosition().left+window.pageXOffset,c=a.offsetY||a.clientY-this._getContentPosition().top+window.pageYOffset;this.mousePos={x:b,y:c}},_setTouchPosition:function(a){if(a.touches!==undefined&amp;&amp;a.touches.length===1){var b=a.touches[0],c=b.clientX-this._getContentPosition().left+window.pageXOffset,d=b.clientY-this._getContentPosition().top+window.pageYOffset;this.touchPos={x:c,y:d}}},_getContentPosition:function(){var a=this.content,b=0,c=0;while(a&amp;&amp;a.tagName!==&quot;BODY&quot;)b+=a.offsetTop-a.scrollTop,c+=a.offsetLeft-a.scrollLeft,a=a.offsetParent;return{top:b,left:c}},_modifyPathContext:function(a){a.stroke=function(){},a.fill=function(){},a.fillRect=function(a,b,c,d){layer.context.rect(a,b,c,d)},a.strokeRect=function(a,b,c,d){layer.context.rect(a,b,c,d)},a.drawImage=function(){},a.fillText=function(){},a.strokeText=function(){}},_endDrag:function(a){var b=Kinetic.GlobalObject;b.drag.node&amp;&amp;b.drag.moving&amp;&amp;(b.drag.moving=!1,b.drag.node._handleEvents(&quot;ondragend&quot;,a)),b.drag.node=undefined},_prepareDrag:function(){var a=this;this.onContent(&quot;mousemove touchmove&quot;,function(b){var c=Kinetic.GlobalObject,d=c.drag.node;if(d){var e=a.getUserPosition(),f=d.dragConstraint,g=d.dragBounds,h={x:e.x-c.drag.offset.x,y:e.y-c.drag.offset.y};g.left!==undefined&amp;&amp;h.x&lt;g.left&amp;&amp;(h.x=g.left),g.right!==undefined&amp;&amp;h.x&gt;g.right&amp;&amp;(h.x=g.right),g.top!==undefined&amp;&amp;h.y&lt;g.top&amp;&amp;(h.y=g.top),g.bottom!==undefined&amp;&amp;h.y&gt;g.bottom&amp;&amp;(h.y=g.bottom);var i=d.rotation,j={x:d.scale.x,y:d.scale.y};d.rotation=0,d.scale={x:1,y:1};var k=d.getAbsoluteTransform();k.invert(),k.translate(h.x,h.y),h={x:d.x+k.getTranslation().x,y:d.y+k.getTranslation().y},f===&quot;horizontal&quot;?h.y=d.y:f===&quot;vertical&quot;&amp;&amp;(h.x=d.x),d.setPosition(h.x,h.y),d.rotate(i),d.scale={x:j.x,y:j.y},c.drag.node.getLayer().draw(),c.drag.moving||(c.drag.moving=!0,c.drag.node._handleEvents(&quot;ondragstart&quot;,b)),c.drag.node._handleEvents(&quot;ondragmove&quot;,b)}},!1),this.onContent(&quot;mouseup touchend mouseout&quot;,function(b){a._endDrag(b)})},_buildDOM:function(){this.content.style.width=this.width+&quot;px&quot;,this.content.style.height=this.height+&quot;px&quot;,this.content.style.position=&quot;relative&quot;,this.content.style.display=&quot;inline-block&quot;,this.content.className=&quot;kineticjs-content&quot;,this.container.appendChild(this.content),this.bufferLayer=new Kinetic.Layer({name:&quot;bufferLayer&quot;}),this.pathLayer=new Kinetic.Layer({name:&quot;pathLayer&quot;}),this.bufferLayer.parent=this,this.pathLayer.parent=this,this._modifyPathContext(this.pathLayer.context),this.bufferLayer.getCanvas().style.display=&quot;none&quot;,this.pathLayer.getCanvas().style.display=&quot;none&quot;,this.bufferLayer.canvas.width=this.width,this.bufferLayer.canvas.height=this.height,this.bufferLayer.canvas.className=&quot;kineticjs-buffer-layer&quot;,this.content.appendChild(this.bufferLayer.canvas),this.pathLayer.canvas.width=this.width,this.pathLayer.canvas.height=this.height,this.pathLayer.canvas.className=&quot;kineticjs-path-layer&quot;,this.content.appendChild(this.pathLayer.canvas)}},Kinetic.GlobalObject.extend(Kinetic.Stage,Kinetic.Container),Kinetic.GlobalObject.extend(Kinetic.Stage,Kinetic.Node),Kinetic.Layer=function(a){this.className=&quot;Layer&quot;,this.canvas=document.createElement(&quot;canvas&quot;),this.context=this.canvas.getContext(&quot;2d&quot;),this.canvas.style.position=&quot;absolute&quot;,this.transitions=[],this.transitionIdCounter=0,Kinetic.Container.apply(this,[]),Kinetic.Node.apply(this,[a])},Kinetic.Layer.prototype={draw:function(){this._draw()},clear:function(){var a=this.getContext(),b=this.getCanvas();a.clearRect(0,0,b.width,b.height)},getCanvas:function(){return this.canvas},getContext:function(){return this.context},add:function(a){this._add(a)},remove:function(a){this._remove(a)},_draw:function(){this.clear(),this.visible&amp;&amp;this._drawChildren()}},Kinetic.GlobalObject.extend(Kinetic.Layer,Kinetic.Container),Kinetic.GlobalObject.extend(Kinetic.Layer,Kinetic.Node),Kinetic.Group=function(a){this.className=&quot;Group&quot;,Kinetic.Container.apply(this,[]),Kinetic.Node.apply(this,[a])},Kinetic.Group.prototype={add:function(a){this._add(a)},remove:function(a){this._remove(a)},_draw:function(){this.visible&amp;&amp;this._drawChildren()}},Kinetic.GlobalObject.extend(Kinetic.Group,Kinetic.Container),Kinetic.GlobalObject.extend(Kinetic.Group,Kinetic.Node),Kinetic.Shape=function(a){this.className=&quot;Shape&quot;,this.data=[];if(a.stroke!==undefined||a.strokeWidth!==undefined)a.stroke===undefined?a.stroke=&quot;black&quot;:a.strokeWidth===undefined&amp;&amp;(a.strokeWidth=2);this.detectionType=&quot;path&quot;,this.drawFunc=a.drawFunc,Kinetic.Node.apply(this,[a])},Kinetic.Shape.prototype={getContext:function(){return this.tempLayer.getContext()},getCanvas:function(){return this.tempLayer.getCanvas()},fillStroke:function(){var a=this.getContext();this.fill!==undefined&amp;&amp;(a.fillStyle=this.fill,a.fill()),this.stroke!==undefined&amp;&amp;(a.lineWidth=this.strokeWidth===undefined?1:this.strokeWidth,a.strokeStyle=this.stroke,a.stroke())},applyLineJoin:function(){var a=this.getContext();this.lineJoin!==undefined&amp;&amp;(a.lineJoin=this.lineJoin)},setFill:function(a){this.fill=a},getFill:function(){return this.fill},setStroke:function(a){this.stroke=a},getStroke:function(){return this.stroke},setLineJoin:function(a){this.lineJoin=a},getLineJoin:function(){return this.lineJoin},setStrokeWidth:function(a){this.strokeWidth=a},getStrokeWidth:function(){return this.strokeWidth},setDrawFunc:function(a){this.drawFunc=a},save:function(){var a=this.getStage(),b=a.width,c=a.height,d=a.bufferLayer,e=d.getContext();d.clear(),this._draw(d);var f=e.getImageData(0,0,b,c);this.data=f.data},_draw:function(a){if(this.visible){var b=a.getStage(),c=a.getContext(),d=[],e=this.parent;d.unshift(this);while(e)d.unshift(e),e=e.parent;c.save();for(var f=0;f&lt;d.length;f++){var g=d[f],h=g.getTransform().getMatrix();c.transform(h[0],h[1],h[2],h[3],h[4],h[5]),g.getAbsoluteAlpha()!==1&amp;&amp;(c.globalAlpha=g.getAbsoluteAlpha())}this.tempLayer=a,this.drawFunc.call(this),c.restore()}},_isPointInShape:function(a){var b=this.getStage();if(this.detectionType===&quot;path&quot;){var c=b.pathLayer,d=c.getContext();return this._draw(c),d.isPointInPath(a.x,a.y)}var e=b.width,f=this.data[(e*a.y+a.x)*4+3];return f!==undefined&amp;&amp;f!==0}},Kinetic.GlobalObject.extend(Kinetic.Shape,Kinetic.Node),Kinetic.Rect=function(a){a.drawFunc=function(){var a=this.getContext();a.beginPath(),this.applyLineJoin(),a.rect(0,0,this.width,this.height),a.closePath(),this.fillStroke()},Kinetic.Shape.apply(this,[a])},Kinetic.Rect.prototype={setWidth:function(a){this.width=a},getWidth:function(){return this.width},setHeight:function(a){this.height=a},getHeight:function(){return this.height},setSize:function(a,b){this.width=a,this.height=b},getSize:function(){return{width:this.width,height:this.height}}},Kinetic.GlobalObject.extend(Kinetic.Rect,Kinetic.Shape),Kinetic.Circle=function(a){a.drawFunc=function(){var a=this.getCanvas(),b=this.getContext();b.beginPath(),this.applyLineJoin(),b.arc(0,0,this.radius,0,Math.PI*2,!0),b.closePath(),this.fillStroke()},Kinetic.Shape.apply(this,[a])},Kinetic.Circle.prototype={setRadius:function(a){this.radius=a},getRadius:function(){return this.radius}},Kinetic.GlobalObject.extend(Kinetic.Circle,Kinetic.Shape),Kinetic.Image=function(a){a.width===undefined&amp;&amp;(a.width=a.image.width),a.height===undefined&amp;&amp;(a.height=a.image.height),a.drawFunc=function(){var a=this.getCanvas(),b=this.getContext();b.beginPath(),this.applyLineJoin(),b.rect(0,0,this.width,this.height),b.closePath(),this.fillStroke(),b.drawImage(this.image,0,0,this.width,this.height)},Kinetic.Shape.apply(this,[a])},Kinetic.Image.prototype={setImage:function(a){this.image=a},getImage:function(){return this.image},setWidth:function(a){this.width=a},getWidth:function(){return this.width},setHeight:function(a){this.height=a},getHeight:function(){return this.height},setSize:function(a,b){this.width=a,this.height=b},getSize:function(){return{width:this.width,height:this.height}}},Kinetic.GlobalObject.extend(Kinetic.Image,Kinetic.Shape),Kinetic.Polygon=function(a){a.drawFunc=function(){var a=this.getContext();a.beginPath(),this.applyLineJoin(),a.moveTo(this.points[0].x,this.points[0].y);for(var b=1;b&lt;this.points.length;b++)a.lineTo(this.points[b].x,this.points[b].y);a.closePath(),this.fillStroke()},Kinetic.Shape.apply(this,[a])},Kinetic.Polygon.prototype={setPoints:function(a){this.points=a},getPoints:function(){return this.points}},Kinetic.GlobalObject.extend(Kinetic.Polygon,Kinetic.Shape),Kinetic.RegularPolygon=function(a){a.drawFunc=function(){var a=this.getContext();a.beginPath(),this.applyLineJoin(),a.moveTo(0,0-this.radius);for(var b=1;b&lt;this.sides;b++){var c=this.radius*Math.sin(b*2*Math.PI/this.sides),d=-1*this.radius*Math.cos(b*2*Math.PI/this.sides);a.lineTo(c,d)}a.closePath(),this.fillStroke()},Kinetic.Shape.apply(this,[a])},Kinetic.RegularPolygon.prototype={setPoints:function(a){this.points=a},getPoints:function(){return this.points},setRadius:function(a){this.radius=a},getRadius:function(){return this.radius},setSides:function(a){this.sides=a},getSides:function(){return this.sides}},Kinetic.GlobalObject.extend(Kinetic.RegularPolygon,Kinetic.Shape),Kinetic.Star=function(a){a.drawFunc=function(){var a=this.getContext();a.beginPath(),this.applyLineJoin(),a.moveTo(0,0-this.outerRadius);for(var b=1;b&lt;this.points*2;b++){var c=b%2===0?this.outerRadius:this.innerRadius,d=c*Math.sin(b*Math.PI/this.points),e=-1*c*Math.cos(b*Math.PI/this.points);a.lineTo(d,e)}a.closePath(),this.fillStroke()},Kinetic.Shape.apply(this,[a])},Kinetic.Star.prototype={setPoints:function(a){this.points=a},getPoints:function(){return this.points},setOuterRadius:function(a){this.outerRadius=a},getOuterRadius:function(){return this.outerRadius},setInnerRadius:function(a){this.innerRadius=a},getInnerRadius:function(){return this.innerRadius}},Kinetic.GlobalObject.extend(Kinetic.Star,Kinetic.Shape),Kinetic.Text=function(a){if(a.textStroke!==undefined||a.textStrokeWidth!==undefined)a.textStroke===undefined?a.textStroke=&quot;black&quot;:a.textStrokeWidth===undefined&amp;&amp;(a.textStrokeWidth=2);a.align===undefined&amp;&amp;(a.align=&quot;left&quot;),a.verticalAlign===undefined&amp;&amp;(a.verticalAlign=&quot;top&quot;),a.padding===undefined&amp;&amp;(a.padding=0),a.fontStyle===undefined&amp;&amp;(a.fontStyle=&quot;normal&quot;),a.drawFunc=function(){var a=this.getContext();a.font=this.fontStyle+&quot; &quot;+this.fontSize+&quot;pt &quot;+this.fontFamily,a.textBaseline=&quot;middle&quot;;var b=this.getTextHeight(),c=this.getTextWidth(),d=this.padding,e=0,f=0;switch(this.align){case&quot;center&quot;:e=c/-2-d;break;case&quot;right&quot;:e=-1*c-d}switch(this.verticalAlign){case&quot;middle&quot;:f=b/-2-d;break;case&quot;bottom&quot;:f=-1*b-d}a.save(),a.beginPath(),this.applyLineJoin(),a.rect(e,f,c+d*2,b+d*2),a.closePath(),this.fillStroke(),a.restore();var g=d+e,h=b/2+d+f;this.textFill!==undefined&amp;&amp;(a.fillStyle=this.textFill,a.fillText(this.text,g,h));if(this.textStroke!==undefined||this.textStrokeWidth!==undefined)this.textStroke===undefined?this.textStroke=&quot;black&quot;:this.textStrokeWidth===undefined&amp;&amp;(this.textStrokeWidth=2),a.lineWidth=this.textStrokeWidth,a.strokeStyle=this.textStroke,a.strokeText(this.text,g,h)},Kinetic.Shape.apply(this,[a])},Kinetic.Text.prototype={setFontFamily:function(a){this.fontFamily=a},getFontFamily:function(){return this.fontFamily},setFontSize:function(a){this.fontSize=a},getFontSize:function(){return this.fontSize},setFontStyle:function(a){this.fontStyle=a},getFontStyle:function(){return this.fontStyle},setTextFill:function(a){this.textFill=a},getTextFill:function(){return this.textFill},setTextStroke:function(a){this.textStroke=a},getTextStroke:function(){return this.textStroke},setTextStrokeWidth:function(a){this.textStrokeWidth=a},getTextStrokeWidth:function(){return this.textStrokeWidth},setPadding:function(a){this.padding=a},getPadding:function(){return this.padding},setAlign:function(a){this.align=a},getAlign:function(){return this.align},setVerticalAlign:function(a){this.verticalAlign=a},getVerticalAlign:function(){return this.verticalAlign},setText:function(a){this.text=a},getText:function(){return this.text},getTextWidth:function(){return this.getTextSize().width},getTextHeight:function(){return this.getTextSize().height},getTextSize:function(){var a=this.getContext();a.save(),a.font=this.fontStyle+&quot; &quot;+this.fontSize+&quot;pt &quot;+this.fontFamily;var b=a.measureText(this.text);return a.restore(),{width:b.width,height:parseInt(this.fontSize,10)}}},Kinetic.GlobalObject.extend(Kinetic.Text,Kinetic.Shape),Kinetic.Transform=function(){this.m=[1,0,0,1,0,0]},Kinetic.Transform.prototype={translate:function(a,b){this.m[4]+=this.m[0]*a+this.m[2]*b,this.m[5]+=this.m[1]*a+this.m[3]*b},scale:function(a,b){this.m[0]*=a,this.m[1]*=a,this.m[2]*=b,this.m[3]*=b},rotate:function(a){var b=Math.cos(a),c=Math.sin(a),d=this.m[0]*b+this.m[2]*c,e=this.m[1]*b+this.m[3]*c,f=this.m[0]*-c+this.m[2]*b,g=this.m[1]*-c+this.m[3]*b;this.m[0]=d,this.m[1]=e,this.m[2]=f,this.m[3]=g},getTranslation:function(){return{x:this.m[4],y:this.m[5]}},multiply:function(a){var b=this.m[0]*a.m[0]+this.m[2]*a.m[1],c=this.m[1]*a.m[0]+this.m[3]*a.m[1],d=this.m[0]*a.m[2]+this.m[2]*a.m[3],e=this.m[1]*a.m[2]+this.m[3]*a.m[3],f=this.m[0]*a.m[4]+this.m[2]*a.m[5]+this.m[4],g=this.m[1]*a.m[4]+this.m[3]*a.m[5]+this.m[5];this.m[0]=b,this.m[1]=c,this.m[2]=d,this.m[3]=e,this.m[4]=f,this.m[5]=g},invert:function(){var a=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),b=this.m[3]*a,c=-this.m[1]*a,d=-this.m[2]*a,e=this.m[0]*a,f=a*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),g=a*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);this.m[0]=b,this.m[1]=c,this.m[2]=d,this.m[3]=e,this.m[4]=f,this.m[5]=g},getMatrix:function(){return this.m}};<br></td></tr
></table></pre>
<pre><table width="100%"><tr class="cursor_stop cursor_hidden"><td></td></tr></table></pre>
</td>
</tr></table>

 
<script type="text/javascript">
 var lineNumUnderMouse = -1;
 
 function gutterOver(num) {
 gutterOut();
 var newTR = document.getElementById('gr_svn196_' + num);
 if (newTR) {
 newTR.className = 'undermouse';
 }
 lineNumUnderMouse = num;
 }
 function gutterOut() {
 if (lineNumUnderMouse != -1) {
 var oldTR = document.getElementById(
 'gr_svn196_' + lineNumUnderMouse);
 if (oldTR) {
 oldTR.className = '';
 }
 lineNumUnderMouse = -1;
 }
 }
 var numsGenState = {table_base_id: 'nums_table_'};
 var srcGenState = {table_base_id: 'src_table_'};
 var alignerRunning = false;
 var startOver = false;
 function setLineNumberHeights() {
 if (alignerRunning) {
 startOver = true;
 return;
 }
 numsGenState.chunk_id = 0;
 numsGenState.table = document.getElementById('nums_table_0');
 numsGenState.row_num = 0;
 if (!numsGenState.table) {
 return; // Silently exit if no file is present.
 }
 srcGenState.chunk_id = 0;
 srcGenState.table = document.getElementById('src_table_0');
 srcGenState.row_num = 0;
 alignerRunning = true;
 continueToSetLineNumberHeights();
 }
 function rowGenerator(genState) {
 if (genState.row_num < genState.table.rows.length) {
 var currentRow = genState.table.rows[genState.row_num];
 genState.row_num++;
 return currentRow;
 }
 var newTable = document.getElementById(
 genState.table_base_id + (genState.chunk_id + 1));
 if (newTable) {
 genState.chunk_id++;
 genState.row_num = 0;
 genState.table = newTable;
 return genState.table.rows[0];
 }
 return null;
 }
 var MAX_ROWS_PER_PASS = 1000;
 function continueToSetLineNumberHeights() {
 var rowsInThisPass = 0;
 var numRow = 1;
 var srcRow = 1;
 while (numRow && srcRow && rowsInThisPass < MAX_ROWS_PER_PASS) {
 numRow = rowGenerator(numsGenState);
 srcRow = rowGenerator(srcGenState);
 rowsInThisPass++;
 if (numRow && srcRow) {
 if (numRow.offsetHeight != srcRow.offsetHeight) {
 numRow.firstChild.style.height = srcRow.offsetHeight + 'px';
 }
 }
 }
 if (rowsInThisPass >= MAX_ROWS_PER_PASS) {
 setTimeout(continueToSetLineNumberHeights, 10);
 } else {
 alignerRunning = false;
 if (startOver) {
 startOver = false;
 setTimeout(setLineNumberHeights, 500);
 }
 }
 }
 function initLineNumberHeights() {
 // Do 2 complete passes, because there can be races
 // between this code and prettify.
 startOver = true;
 setTimeout(setLineNumberHeights, 250);
 window.onresize = setLineNumberHeights;
 }
 initLineNumberHeights();
</script>

 
 
 <div id="log">
 <div style="text-align:right">
 <a class="ifCollapse" href="#" onclick="_toggleMeta(this); return false">Show details</a>
 <a class="ifExpand" href="#" onclick="_toggleMeta(this); return false">Hide details</a>
 </div>
 <div class="ifExpand">
 
 
 <div class="pmeta_bubble_bg" style="border:1px solid white">
 <div class="round4"></div>
 <div class="round2"></div>
 <div class="round1"></div>
 <div class="box-inner">
 <div id="changelog">
 <p>Change log</p>
 <div>
 <a href="/p/masiisteen/source/detail?spec=svn196&amp;r=189">r189</a>
 by stenver1010
 on Apr 22, 2012
 &nbsp; <a href="/p/masiisteen/source/diff?spec=svn196&r=189&amp;format=side&amp;path=/trunk/Battleships/WebContent/Javascript/libraries/kinetic-v3.9.1.min.js&amp;old_path=/trunk/Battleships/WebContent/Javascript/libraries/kinetic-v3.9.1.min.js&amp;old=">Diff</a>
 </div>
 <pre>Fixed silvers bug. Animations need to be
redone</pre>
 </div>
 
 
 
 
 
 
 <script type="text/javascript">
 var detail_url = '/p/masiisteen/source/detail?r=189&spec=svn196';
 var publish_url = '/p/masiisteen/source/detail?r=189&spec=svn196#publish';
 // describe the paths of this revision in javascript.
 var changed_paths = [];
 var changed_urls = [];
 
 changed_paths.push('/trunk/Battleships/WebContent/Javascript/InitGame.js');
 changed_urls.push('/p/masiisteen/source/browse/trunk/Battleships/WebContent/Javascript/InitGame.js?r\x3d189\x26spec\x3dsvn196');
 
 
 changed_paths.push('/trunk/Battleships/WebContent/Javascript/engine/Replay.js');
 changed_urls.push('/p/masiisteen/source/browse/trunk/Battleships/WebContent/Javascript/engine/Replay.js?r\x3d189\x26spec\x3dsvn196');
 
 
 changed_paths.push('/trunk/Battleships/WebContent/Javascript/graphics/Animations.js');
 changed_urls.push('/p/masiisteen/source/browse/trunk/Battleships/WebContent/Javascript/graphics/Animations.js?r\x3d189\x26spec\x3dsvn196');
 
 
 changed_paths.push('/trunk/Battleships/WebContent/Javascript/libraries/kinetic-v3.9.1.min.js');
 changed_urls.push('/p/masiisteen/source/browse/trunk/Battleships/WebContent/Javascript/libraries/kinetic-v3.9.1.min.js?r\x3d189\x26spec\x3dsvn196');
 
 var selected_path = '/trunk/Battleships/WebContent/Javascript/libraries/kinetic-v3.9.1.min.js';
 
 
 changed_paths.push('/trunk/Battleships/WebContent/index.html');
 changed_urls.push('/p/masiisteen/source/browse/trunk/Battleships/WebContent/index.html?r\x3d189\x26spec\x3dsvn196');
 
 
 function getCurrentPageIndex() {
 for (var i = 0; i < changed_paths.length; i++) {
 if (selected_path == changed_paths[i]) {
 return i;
 }
 }
 }
 function getNextPage() {
 var i = getCurrentPageIndex();
 if (i < changed_paths.length - 1) {
 return changed_urls[i + 1];
 }
 return null;
 }
 function getPreviousPage() {
 var i = getCurrentPageIndex();
 if (i > 0) {
 return changed_urls[i - 1];
 }
 return null;
 }
 function gotoNextPage() {
 var page = getNextPage();
 if (!page) {
 page = detail_url;
 }
 window.location = page;
 }
 function gotoPreviousPage() {
 var page = getPreviousPage();
 if (!page) {
 page = detail_url;
 }
 window.location = page;
 }
 function gotoDetailPage() {
 window.location = detail_url;
 }
 function gotoPublishPage() {
 window.location = publish_url;
 }
</script>

 
 <style type="text/css">
 #review_nav {
 border-top: 3px solid white;
 padding-top: 6px;
 margin-top: 1em;
 }
 #review_nav td {
 vertical-align: middle;
 }
 #review_nav select {
 margin: .5em 0;
 }
 </style>
 <div id="review_nav">
 <table><tr><td>Go to:&nbsp;</td><td>
 <select name="files_in_rev" onchange="window.location=this.value">
 
 <option value="/p/masiisteen/source/browse/trunk/Battleships/WebContent/Javascript/InitGame.js?r=189&amp;spec=svn196"
 
 >...ebContent/Javascript/InitGame.js</option>
 
 <option value="/p/masiisteen/source/browse/trunk/Battleships/WebContent/Javascript/engine/Replay.js?r=189&amp;spec=svn196"
 
 >...tent/Javascript/engine/Replay.js</option>
 
 <option value="/p/masiisteen/source/browse/trunk/Battleships/WebContent/Javascript/graphics/Animations.js?r=189&amp;spec=svn196"
 
 >...avascript/graphics/Animations.js</option>
 
 <option value="/p/masiisteen/source/browse/trunk/Battleships/WebContent/Javascript/libraries/kinetic-v3.9.1.min.js?r=189&amp;spec=svn196"
 selected="selected"
 >.../libraries/kinetic-v3.9.1.min.js</option>
 
 <option value="/p/masiisteen/source/browse/trunk/Battleships/WebContent/index.html?r=189&amp;spec=svn196"
 
 >...attleships/WebContent/index.html</option>
 
 </select>
 </td></tr></table>
 
 
 



 
 </div>
 
 
 </div>
 <div class="round1"></div>
 <div class="round2"></div>
 <div class="round4"></div>
 </div>
 <div class="pmeta_bubble_bg" style="border:1px solid white">
 <div class="round4"></div>
 <div class="round2"></div>
 <div class="round1"></div>
 <div class="box-inner">
 <div id="older_bubble">
 <p>Older revisions</p>
 
 <a href="/p/masiisteen/source/list?path=/trunk/Battleships/WebContent/Javascript/libraries/kinetic-v3.9.1.min.js&start=189">All revisions of this file</a>
 </div>
 </div>
 <div class="round1"></div>
 <div class="round2"></div>
 <div class="round4"></div>
 </div>
 
 <div class="pmeta_bubble_bg" style="border:1px solid white">
 <div class="round4"></div>
 <div class="round2"></div>
 <div class="round1"></div>
 <div class="box-inner">
 <div id="fileinfo_bubble">
 <p>File info</p>
 
 <div>Size: 31250 bytes,
 28 lines</div>
 
 <div><a href="//masiisteen.googlecode.com/svn-history/r196/trunk/Battleships/WebContent/Javascript/libraries/kinetic-v3.9.1.min.js">View raw file</a></div>
 </div>
 
 <div id="props">
 <p>File properties</p>
 <dl>
 
 <dt>svn:mime-type</dt>
 <dd>text/plain</dd>
 
 </dl>
 </div>
 
 </div>
 <div class="round1"></div>
 <div class="round2"></div>
 <div class="round4"></div>
 </div>
 </div>
 </div>


</div>

</div>
</div>

<script src="http://www.gstatic.com/codesite/ph/13293733053503680815/js/prettify/prettify.js"></script>
<script type="text/javascript">prettyPrint();</script>


<script src="http://www.gstatic.com/codesite/ph/13293733053503680815/js/source_file_scripts.js"></script>

 <script type="text/javascript" src="https://kibbles.googlecode.com/files/kibbles-1.3.3.comp.js"></script>
 <script type="text/javascript">
 var lastStop = null;
 var initialized = false;
 
 function updateCursor(next, prev) {
 if (prev && prev.element) {
 prev.element.className = 'cursor_stop cursor_hidden';
 }
 if (next && next.element) {
 next.element.className = 'cursor_stop cursor';
 lastStop = next.index;
 }
 }
 
 function pubRevealed(data) {
 updateCursorForCell(data.cellId, 'cursor_stop cursor_hidden');
 if (initialized) {
 reloadCursors();
 }
 }
 
 function draftRevealed(data) {
 updateCursorForCell(data.cellId, 'cursor_stop cursor_hidden');
 if (initialized) {
 reloadCursors();
 }
 }
 
 function draftDestroyed(data) {
 updateCursorForCell(data.cellId, 'nocursor');
 if (initialized) {
 reloadCursors();
 }
 }
 function reloadCursors() {
 kibbles.skipper.reset();
 loadCursors();
 if (lastStop != null) {
 kibbles.skipper.setCurrentStop(lastStop);
 }
 }
 // possibly the simplest way to insert any newly added comments
 // is to update the class of the corresponding cursor row,
 // then refresh the entire list of rows.
 function updateCursorForCell(cellId, className) {
 var cell = document.getElementById(cellId);
 // we have to go two rows back to find the cursor location
 var row = getPreviousElement(cell.parentNode);
 row.className = className;
 }
 // returns the previous element, ignores text nodes.
 function getPreviousElement(e) {
 var element = e.previousSibling;
 if (element.nodeType == 3) {
 element = element.previousSibling;
 }
 if (element && element.tagName) {
 return element;
 }
 }
 function loadCursors() {
 // register our elements with skipper
 var elements = CR_getElements('*', 'cursor_stop');
 var len = elements.length;
 for (var i = 0; i < len; i++) {
 var element = elements[i]; 
 element.className = 'cursor_stop cursor_hidden';
 kibbles.skipper.append(element);
 }
 }
 function toggleComments() {
 CR_toggleCommentDisplay();
 reloadCursors();
 }
 function keysOnLoadHandler() {
 // setup skipper
 kibbles.skipper.addStopListener(
 kibbles.skipper.LISTENER_TYPE.PRE, updateCursor);
 // Set the 'offset' option to return the middle of the client area
 // an option can be a static value, or a callback
 kibbles.skipper.setOption('padding_top', 50);
 // Set the 'offset' option to return the middle of the client area
 // an option can be a static value, or a callback
 kibbles.skipper.setOption('padding_bottom', 100);
 // Register our keys
 kibbles.skipper.addFwdKey("n");
 kibbles.skipper.addRevKey("p");
 kibbles.keys.addKeyPressListener(
 'u', function() { window.location = detail_url; });
 kibbles.keys.addKeyPressListener(
 'r', function() { window.location = detail_url + '#publish'; });
 
 kibbles.keys.addKeyPressListener('j', gotoNextPage);
 kibbles.keys.addKeyPressListener('k', gotoPreviousPage);
 
 
 }
 </script>
<script src="http://www.gstatic.com/codesite/ph/13293733053503680815/js/code_review_scripts.js"></script>
<script type="text/javascript">
 function showPublishInstructions() {
 var element = document.getElementById('review_instr');
 if (element) {
 element.className = 'opened';
 }
 }
 var codereviews;
 function revsOnLoadHandler() {
 // register our source container with the commenting code
 var paths = {'svn196': '/trunk/Battleships/WebContent/Javascript/libraries/kinetic-v3.9.1.min.js'}
 codereviews = CR_controller.setup(
 {"profileUrl":["/u/102382972076143158162/"],"token":"5kvJgJLRw_KIbds78Pzgd2psvK0:1343011108015","assetHostPath":"http://www.gstatic.com/codesite/ph","domainName":null,"assetVersionPath":"http://www.gstatic.com/codesite/ph/13293733053503680815","projectHomeUrl":"/p/masiisteen","relativeBaseUrl":"","projectName":"masiisteen","loggedInUserEmail":"LiuRuTing@gmail.com"}, '', 'svn196', paths,
 CR_BrowseIntegrationFactory);
 
 codereviews.registerActivityListener(CR_ActivityType.REVEAL_DRAFT_PLATE, showPublishInstructions);
 
 codereviews.registerActivityListener(CR_ActivityType.REVEAL_PUB_PLATE, pubRevealed);
 codereviews.registerActivityListener(CR_ActivityType.REVEAL_DRAFT_PLATE, draftRevealed);
 codereviews.registerActivityListener(CR_ActivityType.DISCARD_DRAFT_COMMENT, draftDestroyed);
 
 
 
 
 
 
 
 var initialized = true;
 reloadCursors();
 }
 window.onload = function() {keysOnLoadHandler(); revsOnLoadHandler();};

</script>
<script type="text/javascript" src="http://www.gstatic.com/codesite/ph/13293733053503680815/js/dit_scripts.js"></script>

 
 
 
 <script type="text/javascript" src="http://www.gstatic.com/codesite/ph/13293733053503680815/js/ph_core.js"></script>
 
 
 
 
 <script type="text/javascript" src="/js/codesite_product_dictionary_ph.pack.04102009.js"></script>
</div> 

<div id="footer" dir="ltr">
 <div class="text">
 <a href="/projecthosting/terms.html">Terms</a> -
 <a href="http://www.google.com/privacy.html">Privacy</a> -
 <a href="/p/support/">Project Hosting Help</a>
 </div>
</div>
 <div class="hostedBy" style="margin-top: -20px;">
 <span style="vertical-align: top;">Powered by <a href="http://code.google.com/projecthosting/">Google Project Hosting</a></span>
 </div>

 
 


 
 </body>
</html>

